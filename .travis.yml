os: linux
dist: xenial
language: node_js
jobs:
  include:
  - os: linux
    node_js: 12
  - os: osx
    node_js: 12
addons:
  chrome: stable
  firefox: latest
services:
- xvfb
script:
- npm run ci
before_deploy:
- sed -i 's/"private":\ true/"private":\ false/' package.json
- sed -i -E 's/^dist\/?.*$//' .gitignore
deploy:
  provider: npm
  edge: true
  email:
    secure: ww1P29w6mvispNikPUBhc9iFsc0sYlFNA+aOwsLxl46p2+Jxmb9xlsP2pweswIpQMFzT+SIeFcnqzflfUkmYSN9J5ULHLjAiDptPkzv0dzAAI2VewjiADYdG/Ii/ujdjXGWfFIutwUt6tHlMc3l6Jjlk4RvW3PD0H25f5M5hZz6Jbky8FrQ6z9PKQYUJcDgnW2pg7V7lBssyY8a2gJBRvVJeAR7bMwDGRdxedBdXj3e6CE8SjWdd388yQcJhSdx6JRgim/FNx/05PIElDgZzaaKjzMUNCvYcC1tHNLqmqolKanenWv3OXaEEEcq0p4HmRIWXREOVtkJIbG8vr+lDy7a3YydrTZVZYSKZXS1CtzJFrGLYu4R2NsISLArnftZxK+e2VyzXbpMoiojYgZWcNAbDfY3X9RMxumTc99Rm7zN4iQ3NQOUa9YuQVqRkmCVLsw2XHSqgtpqVDFmpxpuZbi2Kpfyol6ZE4uh12uLehiq/3MYZlPYjmVds1qyYNZLyViu/N3zTw2BuT+tSTT6KIS1a6BeBY6Pq2M5A4dTCu6Xgtd0WXExLHtS1KnQcxbpADjoWD6uQvNspK3s6fbCGBZu08LeSNag7mkgielxIM0jLweknyNX9VlFVNg58R2ZJsMpHjfnUVEIqbhvGx3gmo9vgUbgoHahUkwy98GFr8x0=
  api_token:
    secure: "TxTd7Yz4oMbwKwcP1+smTaBs/RpkFr+Ol6yiPjouqt/NlpsUncF6VKhERVNLQdhurLUNcBviEzn4965UhsV43TYERbNRuepoHmuMmRfxjc4CZJqZTF+id66h/LVhBuTmHebNqUSv3vLS6w7/ktZJE/NrvjxeJpiHt5OQHEUsKIEaY9ZfAPoZREJArsl4QmNjmDzpe7XZw3TOHf7Sc/bSNfgtcIL9iRactUdbS8T6PLGxr9p29j2k+xXz6g0yuS/tYCodDx6eZB0oF3ih/vZBY1w3p9m+GGKbPNFt9GCeI3ggf3wOmkTFz7m68SqtMadFd3kcw+4LBGI05oiWTTBEtncqJAvlRV7d2DPjXglWyYgkYEB3AkeOyh3pId8uySCWXK41kKarP8010lWePObTBNS5jln/20Cdes9yOxEGACh3zmCo7hoIeSQwFQUnFwycs1zYyG6ToV4QidTsHlvs/nJgSX7bTk34/d7JMLBD37NbugPiY47oV73MG6+K6XfIl3jAOrnxX8MvpdT2CiG1dPquvxWPxiwoQldANoAdWYDKM8Jkxf2dsux3SYFdKpcXHVtO/MDXvThQHEYeXA/EDRW9KDx+GLDw2ouK4KloHf6SrFvvqdnbiOje//xNO8QJR87OUDreG0qiMeNVNzpcJWmwJH2CmIeBCGWGF8NDXkQ="
  on:
    node_js: 12
    condition:
    - $TRAVIS_BRANCH = master
    - $TRAVIS_EVENT_TYPE = push
    - $TRAVIS_COMMIT_MESSAGE =~ ^v[0-9]+(\.[0-9]+)*($|\n)
    - $TRAVIS_OS_NAME = linux
notifications:
  email:
    recipients:
    - secure: ww1P29w6mvispNikPUBhc9iFsc0sYlFNA+aOwsLxl46p2+Jxmb9xlsP2pweswIpQMFzT+SIeFcnqzflfUkmYSN9J5ULHLjAiDptPkzv0dzAAI2VewjiADYdG/Ii/ujdjXGWfFIutwUt6tHlMc3l6Jjlk4RvW3PD0H25f5M5hZz6Jbky8FrQ6z9PKQYUJcDgnW2pg7V7lBssyY8a2gJBRvVJeAR7bMwDGRdxedBdXj3e6CE8SjWdd388yQcJhSdx6JRgim/FNx/05PIElDgZzaaKjzMUNCvYcC1tHNLqmqolKanenWv3OXaEEEcq0p4HmRIWXREOVtkJIbG8vr+lDy7a3YydrTZVZYSKZXS1CtzJFrGLYu4R2NsISLArnftZxK+e2VyzXbpMoiojYgZWcNAbDfY3X9RMxumTc99Rm7zN4iQ3NQOUa9YuQVqRkmCVLsw2XHSqgtpqVDFmpxpuZbi2Kpfyol6ZE4uh12uLehiq/3MYZlPYjmVds1qyYNZLyViu/N3zTw2BuT+tSTT6KIS1a6BeBY6Pq2M5A4dTCu6Xgtd0WXExLHtS1KnQcxbpADjoWD6uQvNspK3s6fbCGBZu08LeSNag7mkgielxIM0jLweknyNX9VlFVNg58R2ZJsMpHjfnUVEIqbhvGx3gmo9vgUbgoHahUkwy98GFr8x0=
    on_success: change
    on_failure: always
after_script:
- if [ "$TRAVIS_OS_NAME" != "linux" ]; then exit 0; fi
- gulp bench
